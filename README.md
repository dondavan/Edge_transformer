# Edge_transformer
This is to export model weight from pytorch models to run on ACL


1xW src F16
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 24576
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)6144
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 6144
 rhs->tensor_shape().y() 96
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1
1xW src F16
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 24576
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)6144
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 6144
 rhs->tensor_shape().y() 96
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1
1xW src F16
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 24576
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)6144
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 6144
 rhs->tensor_shape().y() 96
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1







1xW  src F32
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 12288
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)3072
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 3072
 rhs->tensor_shape().y() 192
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1
1xW  src F32
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 12288
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)3072
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 3072
 rhs->tensor_shape().y() 192
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1
1xW  src F32
lhs F32
rhs F32
 lhs->strides_in_bytes()[0] 4
 lhs->strides_in_bytes()[1] 12288
 lhs->strides_in_bytes()[2] 0
 rhs->strides_in_bytes()[0] 4
 rhs->strides_in_bytes()[1] 12288
 rhs->strides_in_bytes()[2] 0
 dst->strides_in_bytes()[0] 4
 dst->strides_in_bytes()[1] 3072
 dst->strides_in_bytes()[2] 0
 data_size_from_type(lhs->data_type()) 4
 data_size_from_type(rhs->data_type()) 4
 data_size_from_type(dst->data_type()) 4
static_cast<int>(dst->info()->dimension(0))768
static_cast<int>(dst->info()->dimension(1))7
rhs->info()->dimension(0)3072
 lhs->tensor_shape().x() 3072
 lhs->tensor_shape().y() 2
 lhs->tensor_shape().z() 1
 rhs->tensor_shape().x() 3072
 rhs->tensor_shape().y() 192
 rhs->tensor_shape().z() 1
 dst->tensor_shape().x() 768
 dst->tensor_shape().y() 7
 dst->tensor_shape().z() 1


- ################# 0 ################# 
[ 5.800000e+01, 8.900000e+01, 9.600000e+01, 5.900000e+01,  ..., 4.800000e+01, 3.000000e+01, 9.600000e+01, 8.000000e+01, ] 
[ 8.000000e+01, 2.100000e+01, 8.200000e+01, 7.300000e+01,  ..., 4.800000e+01, 2.100000e+01, 1.220000e+02, 3.700000e+01, ] 
[ 3.200000e+01, 4.400000e+01, 4.800000e+01, 7.800000e+01,  ..., 4.800000e+01, 1.500000e+01, 7.700000e+01, 8.000000e+01, ] 
[ 3.000000e+01, 4.100000e+01, 9.100000e+01, 5.700000e+01,  ..., 9.900000e+01, 9.100000e+01, 3.200000e+01, 1.200000e+01, ] 
[ 6.600000e+01, 2.000000e+00, 1.250000e+02, 9.600000e+01,  ..., 1.030000e+02, 7.700000e+01, 8.700000e+01, 4.200000e+01, ] 
 ..., 
[ 1.110000e+02, 1.000000e+01, 1.400000e+01, 2.900000e+01,  ..., 1.260000e+02, 1.030000e+02, 1.000000e+00, 1.800000e+01, ] 
[ 1.260000e+02, 5.800000e+01, 8.000000e+00, 1.260000e+02,  ..., 8.000000e+01, 1.800000e+01, 9.600000e+01, 1.200000e+02, ] 
[ 2.900000e+01, 4.800000e+01, 5.700000e+01, 1.030000e+02,  ..., 9.100000e+01, 7.800000e+01, 1.090000e+02, 1.110000e+02, ] 
[ 1.040000e+02, 2.900000e+01, 2.000000e+00, 6.700000e+01,  ..., 1.400000e+01, 1.400000e+01, 5.700000e+01, 8.700000e+01, ] 
[ 1.600000e+01, 4.100000e+01, 4.100000e+01, 5.000000e+00,  ..., 4.400000e+01, 6.700000e+01, 3.900000e+01, 1.300000e+01, ] 

---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ -3.736564e-02, 6.481855e-02, 6.728482e-03, -5.154968e-02,  ..., 4.528401e-03, 3.873204e-02, 6.728482e-03, -1.148175e-02, ] 
[ -1.148175e-02, -1.329368e-02, -5.620326e-02, 1.075543e-02,  ..., 4.528401e-03, -1.329368e-02, 2.080218e-02, -2.082406e-03, ] 
[ -3.564632e-02, -1.521711e-02, 4.528401e-03, -2.401135e-02,  ..., 4.528401e-03, 4.790619e-02, -2.847897e-02, -1.148175e-02, ] 
[ 3.873204e-02, 2.443095e-02, -4.450352e-02, 4.320357e-02,  ..., 5.042122e-02, -4.450352e-02, -3.564632e-02, -5.390846e-02, ] 
[ 5.576696e-02, 8.824104e-03, 7.157688e-02, 6.728482e-03,  ..., -1.724559e-02, -2.847897e-02, 9.794910e-05, -2.631478e-02, ] 
 ..., 
[ -3.904550e-02, 1.073183e-01, -3.043689e-02, -4.675399e-02,  ..., -9.772774e-03, -1.724559e-02, -2.166991e-02, 2.301858e-03, ] 
[ -9.772774e-03, -3.736564e-02, -6.233187e-03, -9.772774e-03,  ..., -1.148175e-02, 2.301858e-03, 6.728482e-03, -3.222110e-02, ] 
[ -4.675399e-02, 4.528401e-03, 4.320357e-02, -1.724559e-02,  ..., -4.450352e-02, -2.401135e-02, 4.095570e-02, -3.904550e-02, ] 
[ 2.645693e-02, -4.675399e-02, 8.824104e-03, 1.591162e-02,  ..., -3.043689e-02, -3.043689e-02, 4.320357e-02, 9.794910e-05, ] 
[ 1.919319e-02, 2.443095e-02, 2.443095e-02, 3.448779e-02,  ..., -1.521711e-02, 1.591162e-02, 5.304072e-02, 2.850478e-02, ] 

---------- Result ----------
x: 3072
y: 7
z: 1
 ################# 0 ################# 
[ -1.023758e+00, -2.176445e+00, 5.725693e-01, -4.495755e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -1.038285e+00, -1.207328e+00, -1.419361e+00, 1.599226e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -8.641566e-01, -8.496270e-01, -9.103382e-01, 5.578530e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -2.370422e-01, -5.422184e-01, -1.916886e-01, 7.882493e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -6.401902e-01, -4.150468e-01, -5.082318e-01, 6.464579e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
 ..., 
[ -8.641566e-01, -8.496270e-01, -9.103382e-01, 5.578530e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -2.370422e-01, -5.422184e-01, -1.916886e-01, 7.882493e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -6.401902e-01, -4.150468e-01, -5.082318e-01, 6.464579e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -2.568758e-01, -4.030833e-01, -3.309171e-01, 5.061292e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -4.057831e-01, -6.503879e-01, -3.212453e-01, 5.780897e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 




linear 2:
1xW dst F16
 src->tensor_shape().x() 768
 src->tensor_shape().y() 3072
 src->tensor_shape().z() 1
 dst->tensor_shape().x() 12288
 dst->tensor_shape().y() 192
 dst->tensor_shape().z() 1
 cpu linear 2




ori transpose:

1W
---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ -2.166991e-02, 1.075543e-02, -1.329368e-02, 2.443095e-02, 5.304072e-02, -8.067922e-03, -6.073820e-02, 1.075543e-02,  ..., -1.148175e-02, -1.724559e-02, 5.042122e-02, -7.113647e-02, 4.550598e-02, 1.919319e-02, 1.006588e-01, 2.301858e-03, ] 
[ 1.422836e-02, 1.253237e-02, 6.164173e-02, -4.914004e-02, 1.591162e-02, 1.757746e-02, 3.448779e-02, -9.772774e-03,  ..., 3.448779e-02, 9.794910e-05, -2.166991e-02, -3.043689e-02, 6.728482e-03, -2.401135e-02, 3.051479e-02, -4.914004e-02, ] 
[ -1.724559e-02, -1.521711e-02, -1.148175e-02, -6.233187e-03, -3.043689e-02, 6.728482e-03, 6.164173e-02, -2.847897e-02,  ..., 4.095570e-02, 4.550598e-02, -3.393076e-02, -9.320657e-02, -6.818731e-02, 1.591162e-02, -2.401135e-02, -1.939630e-02, ] 
[ -3.564632e-02, -3.393076e-02, -3.043689e-02, 1.757746e-02, 1.591162e-02, -7.452229e-02, -4.218373e-03, -8.067922e-03,  ..., 5.862553e-02, -2.082406e-03, 2.645693e-02, -6.233187e-03, 9.794910e-05, 4.095570e-02, 1.073183e-01, 3.873204e-02, ] 
[ -4.450352e-02, -4.914004e-02, 4.528401e-03, -6.554513e-02, -6.233187e-03, -1.939630e-02, -6.233187e-03, -3.736564e-02,  ..., -6.073820e-02, 1.757746e-02, -2.166991e-02, -1.329368e-02, 4.790619e-02, 3.448779e-02, 2.850478e-02, -5.620326e-02, ] 
[ 8.824104e-03, 1.757746e-02, 4.528401e-03, 2.252608e-02, -2.631478e-02, 6.812920e-02, -2.847897e-02, -2.847897e-02,  ..., -2.082406e-03, -1.939630e-02, 1.919319e-02, -6.233187e-03, 2.645693e-02, -4.450352e-02, 8.377831e-02, -5.154968e-02, ] 
[ 2.080218e-02, 5.576696e-02, -3.043689e-02, -1.060735e-01, 3.873204e-02, -6.233187e-03, -3.222110e-02, 3.656117e-02,  ..., 2.301858e-03, -2.847897e-02, -2.847897e-02, 7.525747e-02, -5.846236e-02, 2.080218e-02, -1.148175e-02, -5.154968e-02, ] 
[ 3.448779e-02, 2.301858e-03, -3.736564e-02, -1.939630e-02, 2.850478e-02, -7.835175e-02, -3.043689e-02, 1.757746e-02,  ..., 3.448779e-02, 3.656117e-02, -2.166991e-02, 1.422836e-02, 8.880432e-02, 1.075543e-02, 6.164173e-02, 1.757746e-02, ] 
 ..., 
[ 2.252608e-02, -1.148175e-02, 4.095570e-02, 1.422836e-02,  ..., -3.393076e-02, 1.253237e-02, 6.728482e-03, 2.645693e-02, ] 
[ 3.873204e-02, -8.067922e-03, -3.564632e-02, -4.218373e-03,  ..., 2.443095e-02, -1.148175e-02, -1.724559e-02, 3.656117e-02, ] 
[ -4.248989e-02, -2.166991e-02, 5.862553e-02, 8.880432e-02,  ..., -1.724559e-02, 2.252608e-02, -4.914004e-02, -3.904550e-02, ] 
[ -1.148175e-02, 1.073183e-01, -1.939630e-02, 5.576696e-02,  ..., -4.218373e-03, 5.304072e-02, 4.528401e-03, 7.157688e-02, ] 
[ -1.329368e-02, -2.401135e-02, -1.148175e-02, -3.736564e-02,  ..., 1.757746e-02, 1.253237e-02, 8.880432e-02, 1.422836e-02, ] 

---------- Result ----------
x: 768
y: 3072
z: 1
 ################# 0 ################# 
[ -2.166991e-02, 1.075543e-02, -1.329368e-02, 2.443095e-02, 1.422836e-02, 1.253237e-02, 6.164173e-02, -4.914004e-02,  ..., -1.148175e-02, 1.073183e-01, -1.939630e-02, 5.576696e-02, -1.329368e-02, -2.401135e-02, -1.148175e-02, -3.736564e-02, ] 
[ 5.304072e-02, -8.067922e-03, -6.073820e-02, 1.075543e-02, 1.591162e-02, 1.757746e-02, 3.448779e-02, -9.772774e-03,  ..., -5.620326e-02, -2.401135e-02, -2.082406e-03, 1.422836e-02, -1.011836e-01, -8.067922e-03, 4.550598e-02, -2.166991e-02, ] 
[ -9.772774e-03, -1.521711e-02, -2.166991e-02, -4.914004e-02, 2.301858e-03, 4.528401e-03, 4.320357e-02, 3.448779e-02,  ..., 8.824104e-03, -2.166991e-02, 8.824104e-03, -2.847897e-02, -1.148175e-02, 1.757746e-02, -4.218373e-03, 2.080218e-02, ] 
[ -1.939630e-02, 3.656117e-02, -3.043689e-02, 4.320357e-02, -1.148175e-02, -1.724559e-02, 4.528401e-03, 4.528401e-03,  ..., -1.521711e-02, 6.164173e-02, 2.443095e-02, -1.329368e-02, -3.043689e-02, -2.166991e-02, 5.304072e-02, -2.847897e-02, ] 
[ 1.591162e-02, -3.564632e-02, 6.812920e-02, 5.304072e-02, 5.042122e-02, 4.790619e-02, 1.422836e-02, -2.631478e-02,  ..., 5.304072e-02, 9.794910e-05, -1.148175e-02, -9.772774e-03, -3.043689e-02, -2.847897e-02, -2.631478e-02, 3.249368e-02, ] 
[ -1.521711e-02, 4.550598e-02, 9.794910e-05, -4.218373e-03, -2.847897e-02, 3.249368e-02, 1.075543e-02, 9.794910e-05,  ..., -1.724559e-02, 5.862553e-02, -6.233187e-03, 1.075543e-02, -1.521711e-02, 9.794910e-05, 1.757746e-02, 2.301858e-03, ] 
[ 3.656117e-02, -1.521711e-02, 2.645693e-02, -1.011836e-01, 5.042122e-02, 3.656117e-02, 2.850478e-02, -5.620326e-02,  ..., -3.564632e-02, -8.067922e-03, 2.850478e-02, 2.645693e-02, -4.450352e-02, 4.095570e-02, -1.329368e-02, 6.481855e-02, ] 
[ -3.564632e-02, 2.850478e-02, -1.939630e-02, 4.320357e-02, -5.154968e-02, -8.067922e-03, 1.253237e-02, -6.233187e-03,  ..., -2.847897e-02, 2.301858e-03, 4.790619e-02, -4.071184e-02, -2.082406e-03, -4.914004e-02, 2.252608e-02, -2.082406e-03, ] 
 ..., 
[ -6.073820e-02, 1.253237e-02, -1.521711e-02, -3.222110e-02,  ..., -1.329368e-02, 2.645693e-02, -2.401135e-02, 9.794910e-05, ] 
[ -3.222110e-02, 3.656117e-02, -9.691434e-02, 7.525747e-02,  ..., -6.233187e-03, -5.390846e-02, -4.218373e-03, 7.157688e-02, ] 
[ -9.320657e-02, 1.075543e-02, 9.794910e-05, 2.301858e-03,  ..., 1.757746e-02, -2.082406e-03, -6.073820e-02, -1.329368e-02, ] 
[ -1.148175e-02, -1.724559e-02, 5.042122e-02, -7.113647e-02,  ..., 3.249368e-02, -1.521711e-02, -2.631478e-02, -6.233187e-03, ] 
[ 4.550598e-02, 1.919319e-02, 1.006588e-01, 2.301858e-03,  ..., 1.757746e-02, 1.253237e-02, 8.880432e-02, 1.422836e-02, ] 





transposed:
---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ 1.000000e+00, 7.300000e+01, 2.100000e+01, 4.100000e+01,  ..., 7.700000e+01, 3.400000e+01, 9.600000e+01, 1.050000e+02, ] 
[ 9.500000e+01, 0.000000e+00, 1.150000e+02, 1.050000e+02,  ..., 9.600000e+01, 7.800000e+01, 8.400000e+01, 1.160000e+02, ] 
[ 1.030000e+02, 4.400000e+01, 8.000000e+01, 8.000000e+00,  ..., 1.800000e+01, 1.200000e+02, 9.100000e+01, 1.030000e+02, ] 
[ 4.800000e+01, 6.200000e+01, 1.260000e+02, 1.000000e+00,  ..., 8.700000e+01, 1.090000e+02, 1.000000e+01, 3.000000e+01, ] 
[ 9.100000e+01, 1.160000e+02, 4.800000e+01, 1.140000e+02,  ..., 8.000000e+01, 1.400000e+01, 6.300000e+01, 1.600000e+01, ] 
 ..., 
[ 1.030000e+02, 8.000000e+01, 1.030000e+02, 1.220000e+02,  ..., 8.100000e+01, 1.130000e+02, 9.600000e+01, 1.040000e+02, ] 
[ 3.000000e+01, 6.300000e+01, 3.200000e+01, 6.200000e+01,  ..., 1.000000e+00, 4.800000e+01, 4.100000e+01, 5.000000e+00, ] 
[ 1.160000e+02, 0.000000e+00, 9.900000e+01, 3.400000e+01,  ..., 1.030000e+02, 7.600000e+01, 1.160000e+02, 1.110000e+02, ] 
[ 8.000000e+01, 1.000000e+01, 5.500000e+01, 6.600000e+01,  ..., 5.800000e+01, 8.700000e+01, 4.100000e+01, 7.800000e+01, ] 
[ 8.000000e+00, 1.200000e+01, 3.700000e+01, 6.300000e+01,  ..., 1.050000e+02, 1.130000e+02, 6.500000e+01, 3.400000e+01, ] 

---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ -2.166991e-02, 1.075543e-02, -1.329368e-02, 2.443095e-02,  ..., -2.847897e-02, 1.422836e-02, 6.728482e-03, 1.757746e-02, ] 
[ -4.071184e-02, 7.929009e-02, -5.846236e-02, 1.757746e-02,  ..., 6.728482e-03, -2.401135e-02, 3.051479e-02, -4.914004e-02, ] 
[ -1.724559e-02, -1.521711e-02, -1.148175e-02, -6.233187e-03,  ..., 2.301858e-03, -3.222110e-02, -4.450352e-02, -1.724559e-02, ] 
[ 4.528401e-03, -4.218373e-03, -9.772774e-03, -2.166991e-02,  ..., 9.794910e-05, 4.095570e-02, 1.073183e-01, 3.873204e-02, ] 
[ -4.450352e-02, -4.914004e-02, 4.528401e-03, -6.554513e-02,  ..., -1.148175e-02, -3.043689e-02, -8.067922e-03, 1.919319e-02, ] 
 ..., 
[ -1.724559e-02, -1.148175e-02, -1.724559e-02, 2.080218e-02,  ..., -3.393076e-02, 1.253237e-02, 6.728482e-03, 2.645693e-02, ] 
[ 3.873204e-02, -8.067922e-03, -3.564632e-02, -4.218373e-03,  ..., -2.166991e-02, 4.528401e-03, 2.443095e-02, 3.448779e-02, ] 
[ -4.914004e-02, 7.929009e-02, 5.042122e-02, 1.422836e-02,  ..., -1.724559e-02, 2.252608e-02, -4.914004e-02, -3.904550e-02, ] 
[ -1.148175e-02, 1.073183e-01, -1.939630e-02, 5.576696e-02,  ..., -3.736564e-02, 9.794910e-05, 2.443095e-02, -2.401135e-02, ] 
[ -6.233187e-03, -5.390846e-02, -2.082406e-03, -8.067922e-03,  ..., 1.757746e-02, 1.253237e-02, 8.880432e-02, 1.422836e-02, ] 

---------- Result ----------
x: 3072
y: 7
z: 1
 ################# 0 ################# 
[ -5.077857e-01, -5.483395e-01, -6.212230e-01, -5.871054e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -5.343881e-01, -5.550627e-01, -6.238974e-01, -6.562371e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ -5.174059e-01, -5.314108e-01, -5.562696e-01, -6.734017e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 1.778272e-01, -3.682034e-01, -1.854481e-02, -6.007528e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 2.459020e-01, -3.213066e-01, 1.058663e-01, -5.776149e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
 ..., 
[ -5.174059e-01, -5.314108e-01, -5.562696e-01, -6.734017e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 1.778272e-01, -3.682034e-01, -1.854481e-02, -6.007528e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 2.459020e-01, -3.213066e-01, 1.058663e-01, -5.776149e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 5.528593e-02, -3.682716e-01, 1.077040e-01, -7.146799e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 2.411057e-02, -3.969197e-01, 9.653905e-02, -7.244337e-01,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ]










no vector:

---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ 1.000000e+00, 7.300000e+01, 2.100000e+01, 4.100000e+01, 3.400000e+01, 1.130000e+02, 9.000000e+00, 1.160000e+02,  ..., 7.300000e+01, 5.400000e+01, 1.800000e+01, 2.100000e+01, 7.700000e+01, 3.400000e+01, 9.600000e+01, 1.050000e+02, ] 
[ 9.500000e+01, 0.000000e+00, 1.150000e+02, 1.050000e+02, 1.130000e+02, 4.200000e+01, 1.160000e+02, 1.110000e+02,  ..., 1.010000e+02, 1.600000e+01, 5.100000e+01, 1.800000e+01, 9.600000e+01, 7.800000e+01, 9.100000e+01, 1.030000e+02, ] 
[ 4.800000e+01, 6.200000e+01, 1.260000e+02, 1.000000e+00, 1.130000e+02, 1.800000e+01, 6.600000e+01, 2.100000e+01,  ..., 7.000000e+01, 6.700000e+01, 7.800000e+01, 5.500000e+01, 8.700000e+01, 1.090000e+02, 1.000000e+01, 3.000000e+01, ] 
[ 9.300000e+01, 1.400000e+01, 3.000000e+00, 1.040000e+02, 5.500000e+01, 4.400000e+01, 1.300000e+01, 7.800000e+01,  ..., 1.500000e+01, 5.000000e+00, 1.300000e+01, 8.200000e+01, 1.040000e+02, 9.100000e+01, 7.100000e+01, 5.900000e+01, ] 
[ 4.800000e+01, 2.000000e+00, 4.400000e+01, 6.700000e+01, 1.400000e+01, 3.700000e+01, 8.000000e+01, 5.800000e+01,  ..., 1.150000e+02, 1.220000e+02, 8.000000e+01, 5.900000e+01, 6.500000e+01, 7.300000e+01, 9.000000e+00, 1.050000e+02, ] 
[ 6.500000e+01, 5.700000e+01, 1.010000e+02, 9.500000e+01, 7.600000e+01, 7.600000e+01, 1.260000e+02, 1.100000e+02,  ..., 6.200000e+01, 4.800000e+01, 3.200000e+01, 1.260000e+02, 1.030000e+02, 1.200000e+02, 9.600000e+01, 9.100000e+01, ] 
[ 5.000000e+00, 3.000000e+00, 6.000000e+00, 1.200000e+01, 1.030000e+02, 4.100000e+01, 1.500000e+01, 2.100000e+01,  ..., 3.400000e+01, 9.000000e+01, 1.090000e+02, 1.800000e+01, 6.600000e+01, 6.000000e+00, 1.220000e+02, 7.700000e+01, ] 
[ 8.900000e+01, 3.400000e+01, 4.400000e+01, 6.700000e+01, 9.600000e+01, 5.500000e+01, 3.000000e+01, 5.500000e+01,  ..., 7.700000e+01, 1.010000e+02, 1.400000e+01, 8.400000e+01, 9.600000e+01, 7.300000e+01, 8.400000e+01, 1.300000e+01, ] 
 ..., 
[ 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 
[ 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,  ..., 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ] 

---------- Result ----------
x: 12288
y: 192
z: 1
 ################# 0 ################# 
[ -2.166991e-02, 1.075543e-02, -1.329368e-02, 2.443095e-02, 1.422836e-02, 1.253237e-02, 6.164173e-02, -4.914004e-02,  ..., 1.075543e-02, -7.835175e-02, 2.301858e-03, -1.329368e-02, -2.847897e-02, 1.422836e-02, 6.728482e-03, 1.757746e-02, ] 
[ -4.071184e-02, 7.929009e-02, -5.846236e-02, 1.757746e-02, 1.253237e-02, -2.631478e-02, -4.914004e-02, -3.904550e-02,  ..., 4.550598e-02, 1.919319e-02, 1.006588e-01, 2.301858e-03, 6.728482e-03, -2.401135e-02, -4.450352e-02, -1.724559e-02, ] 
[ 4.528401e-03, -4.218373e-03, -9.772774e-03, -2.166991e-02, 1.253237e-02, 2.301858e-03, 5.576696e-02, -1.329368e-02,  ..., -6.818731e-02, 1.591162e-02, -2.401135e-02, -1.939630e-02, 9.794910e-05, 4.095570e-02, 1.073183e-01, 3.873204e-02, ] 
[ 5.862553e-02, -3.043689e-02, -7.113647e-02, 2.645693e-02, -1.939630e-02, -1.521711e-02, 2.850478e-02, -2.401135e-02,  ..., 4.790619e-02, 3.448779e-02, 2.850478e-02, -5.620326e-02, 2.645693e-02, -4.450352e-02, 8.377831e-02, -5.154968e-02, ] 
[ 4.528401e-03, 8.824104e-03, -1.521711e-02, 1.591162e-02, -3.043689e-02, -2.082406e-03, -1.148175e-02, -3.736564e-02,  ..., -5.846236e-02, 2.080218e-02, -1.148175e-02, -5.154968e-02, 8.880432e-02, 1.075543e-02, 6.164173e-02, 1.757746e-02, ] 
[ 8.880432e-02, 4.320357e-02, 4.550598e-02, -4.071184e-02, 2.252608e-02, 2.252608e-02, -9.772774e-03, -8.624674e-02,  ..., -4.218373e-03, 4.528401e-03, -3.564632e-02, -9.772774e-03, -1.724559e-02, -3.222110e-02, 6.728482e-03, -4.450352e-02, ] 
[ 3.448779e-02, -7.113647e-02, -4.248989e-02, -5.390846e-02, -1.724559e-02, 2.443095e-02, 4.790619e-02, -1.329368e-02,  ..., 1.422836e-02, 3.656117e-02, 4.095570e-02, 2.301858e-03, 5.576696e-02, -4.248989e-02, 2.080218e-02, -2.847897e-02, ] 
[ 6.481855e-02, 1.422836e-02, -1.521711e-02, 1.591162e-02, 6.728482e-03, -1.939630e-02, 3.873204e-02, -1.939630e-02,  ..., -2.847897e-02, 4.550598e-02, -3.043689e-02, 3.051479e-02, 6.728482e-03, 1.075543e-02, 3.051479e-02, 2.850478e-02, ] 
 ..., 
[ 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02,  ..., 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02, ] 
[ 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02,  ..., 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02, ] 
[ 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02,  ..., 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02, ] 
[ 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02,  ..., 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02, ] 
[ 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02,  ..., 7.929009e-02, 7.929009e-02, 7.929009e-02, 7.929009e-02, ] 







int8 without bypass:

switching/src/graph/GraphManager.cpp call_all_output_node_accessors start:
---------- Result ----------
x: 768
y: 7
z: 1
 ################# 0 ################# 
[ -7.689111e-01, -5.074472e-01, 7.813827e-01, 6.889011e-01,  ..., -4.396981e-01, -2.775994e-01, -5.795793e-01, 8.116280e-01, ] 
[ -8.355805e-01, -4.517293e-01, 7.170928e-01, 6.239974e-01,  ..., -4.768278e-01, -1.544477e-01, -6.408268e-01, 7.919048e-01, ] 
[ -7.884799e-01, -4.388122e-01, 6.532022e-01, 7.148867e-01,  ..., -3.813974e-01, -2.822095e-01, -5.718149e-01, 6.947185e-01, ] 
[ -8.050850e-01, -3.509787e-01, 4.838045e-01, 7.604508e-01,  ..., -4.281181e-01, -3.571343e-01, -4.899558e-01, 8.086854e-01, ] 
[ -8.120269e-01, -4.623525e-01, 6.359924e-01, 7.405361e-01,  ..., -4.078928e-01, -2.548257e-01, -6.187838e-01, 8.321655e-01, ] 
[ -8.128483e-01, -3.739851e-01, 6.634884e-01, 7.309539e-01,  ..., -5.011686e-01, -3.513434e-01, -4.939300e-01, 8.111759e-01, ] 
[ -8.181123e-01, -3.937271e-01, 6.523557e-01, 5.834376e-01,  ..., -4.494340e-01, -8.964839e-02, -4.571810e-01, 7.962536e-01, ] 













































Al 1
 weight 
---------- Result ----------
x: 3072
y: 192
z: 1
 ################# 0 ################# 
[ -1.728961e-02, -3.290768e-02, 9.683584e-03, -4.398917e-02, 2.591513e-02, 3.497662e-02, 3.307608e-02, -3.483064e-03,  ..., 7.496781e-02, 1.411156e-01, 2.591513e-02, 9.683584e-03, 5.379406e-02, 7.771323e-03, -4.627629e-02, -2.480576e-02, ] 
[ -2.297673e-02, 1.349843e-02, -3.080665e-02, -3.080665e-02, 2.938193e-02, -5.081355e-02, -1.728961e-02, -4.165864e-02,  ..., -3.080665e-02, -3.483064e-03, 1.928704e-02, -1.532673e-02, 2.430326e-02, 1.349843e-02, -3.711399e-02, 2.105636e-02, ] 
[ 7.937638e-02, 1.157492e-02, -3.483064e-03, -3.080665e-02, 1.545564e-02, 5.379406e-02, -5.566349e-02, 2.760594e-02,  ..., 9.683584e-03, 5.786048e-03, -1.922545e-02, 2.271003e-02, 9.683584e-03, 7.771323e-03, -1.728961e-02, 5.082482e-02, ] 
[ 4.089477e-02, -2.297673e-02, -1.728961e-02, -3.711399e-02, -9.174454e-03, -1.217034e-01, 1.545564e-02, -1.331571e-02,  ..., 2.271003e-02, -4.853181e-02, 2.271003e-02, 1.545564e-02, -5.081355e-02, 3.121246e-02, -3.711399e-02, 1.740456e-02, ] 
[ 2.430326e-02, -2.112579e-02, -4.627629e-02, 1.928704e-02, 5.786048e-03, 3.497662e-02, -1.125001e-02, -3.934286e-02,  ..., -1.532673e-02, 3.121246e-02, -7.159228e-03, -5.566349e-02, -5.826017e-02, -5.258940e-03, 9.683584e-03, -6.399561e-05, ] 
[ 1.157492e-02, 3.754228e-03, -4.627629e-02, -4.398917e-02, -6.599312e-02, 3.121246e-02, 2.271003e-02, -5.081355e-02,  ..., -2.870734e-02, -3.080665e-02, -7.159228e-03, -3.934286e-02, -2.669331e-02, -3.290768e-02, 1.928704e-02, 2.938193e-02, ] 
[ 4.304650e-02, 2.105636e-02, -1.922545e-02, -3.934286e-02, 1.349843e-02, 6.323280e-02, -2.669331e-02, 2.591513e-02,  ..., -4.853181e-02, 2.760594e-02, 1.157492e-02, 8.407630e-02, -6.348684e-02, -9.174454e-03, -3.290768e-02, 4.304650e-02, ] 
[ 6.685986e-02, 1.740456e-02, 3.691056e-02, 2.591513e-02, -2.870734e-02, -4.398917e-02, -1.532673e-02, -5.566349e-02,  ..., 1.157492e-02, -3.483064e-03, -2.870734e-02, -3.498925e-02, 7.771323e-03, -7.698583e-02, -1.331571e-02, -4.165864e-02, ] 
 ..., 
[ 5.379406e-02, 1.157492e-02, 6.685986e-02, 2.105636e-02,  ..., 1.740456e-02, 4.540269e-02, 9.440011e-02, -2.112579e-02, ] 
[ -1.439550e-01, 7.496781e-02, -2.112579e-02, -3.080665e-02,  ..., 2.760594e-02, -1.033672e-01, 5.786048e-03, -2.297673e-02, ] 
[ -1.125001e-02, -2.480576e-02, -3.498925e-02, 5.992197e-02,  ..., 2.760594e-02, -1.147349e-01, -2.297673e-02, -3.711399e-02, ] 
[ -2.112579e-02, 3.307608e-02, 1.157492e-02, 2.760594e-02,  ..., -9.174454e-03, -2.480576e-02, -2.112579e-02, 8.909553e-02, ] 
[ 2.430326e-02, -9.174454e-03, -1.922545e-02, 1.776260e-03,  ..., -3.498925e-02, -5.317811e-02, 4.800027e-02, -9.174454e-03, ] 

 product 
---------- Result ----------
x: 768
y: 7
z: 1
 ################# 0 ################# 
[ 3.924650e-02, 9.361476e-02, 9.184770e-02, 2.950755e-02, 4.685021e-02, -1.297135e-01, 6.039289e-02, -1.154094e-01,  ..., 1.418588e-02, -1.142445e-01, 1.145211e-01, 3.953048e-01, -3.621186e-02, -1.070762e-01, 4.874843e-02, -5.266200e-01, ] 
[ 4.143488e-02, 1.413894e-01, 5.427619e-02, -7.982559e-02, -4.662447e-01, -1.861778e-01, 9.128024e-02, 3.421871e-02,  ..., 6.688146e-02, -7.242206e-02, 9.761456e-02, 1.203156e-01, -2.943624e-02, 6.222770e-02, 2.908439e-02, -4.983969e-01, ] 
[ -5.405808e-02, 1.188394e-01, 7.114087e-02, -3.765433e-02, -4.462232e-01, -2.365903e-01, 3.293276e-02, 9.809070e-02,  ..., 4.342605e-02, -2.983306e-02, 1.289006e-01, 1.109866e-01, -5.303912e-02, 4.445180e-02, 3.219621e-02, -5.422821e-01, ] 
[ 5.663948e-02, 3.388370e-02, 8.750667e-02, -4.487919e-02, -5.568376e-01, -2.611065e-01, 5.938331e-02, 4.061509e-02,  ..., 2.594768e-02, -1.225454e-01, 1.057863e-01, 1.776342e-01, -6.200832e-02, 3.081985e-02, 3.165052e-02, -5.375504e-01, ] 
[ 4.230074e-02, 1.178669e-01, 3.714530e-02, -1.653891e-02, -5.054312e-01, -3.395230e-01, 9.224629e-02, 3.217445e-02,  ..., -9.267742e-03, 6.815962e-02, 8.684927e-02, 2.052440e-01, -1.130996e-01, -4.990990e-02, -8.458284e-02, -5.931165e-01, ] 
[ 8.352942e-02, 2.775572e-02, 4.761885e-02, -4.010019e-02, -5.672011e-01, -2.228299e-01, 2.277424e-03, 3.608413e-02,  ..., 2.386539e-02, -4.609939e-02, 1.948188e-01, 2.014240e-01, -8.882302e-02, 1.358912e-02, 3.388578e-02, -5.943648e-01, ] 
[ 4.737051e-02, 7.541806e-02, 5.489171e-02, -7.638575e-02, -5.484998e-01, -2.306844e-01, 2.061141e-02, -1.911820e-02,  ..., -2.639217e-02, -2.317461e-02, 2.244467e-01, 1.403713e-01, -7.313298e-02, -4.298422e-02, 1.652726e-03, -5.294748e-01, ] 
 ..., 
[ -5.405808e-02, 1.188394e-01, 7.114087e-02, -3.765433e-02,  ..., -5.303912e-02, 4.445180e-02, 3.219621e-02, -5.422821e-01, ] 
[ 5.663948e-02, 3.388370e-02, 8.750667e-02, -4.487919e-02,  ..., -6.200832e-02, 3.081985e-02, 3.165052e-02, -5.375504e-01, ] 
[ 4.230074e-02, 1.178669e-01, 3.714530e-02, -1.653891e-02,  ..., -1.130996e-01, -4.990990e-02, -8.458284e-02, -5.931165e-01, ] 
[ 8.352942e-02, 2.775572e-02, 4.761885e-02, -4.010019e-02,  ..., -8.882302e-02, 1.358912e-02, 3.388578e-02, -5.943648e-01, ] 
[ 4.737051e-02, 7.541806e-02, 5.489171e-02, -7.638575e-02,  ..., -7.313298e-02, -4.298422e-02, 1.652726e-03, -5.294748e-01, ] 

 weight 
---------- Result ----------
x: 3072
y: 192
z: 1
 ################# 0 ################# 
[ 7.771323e-03, 2.591513e-02, -1.922545e-02, 1.740456e-02, -3.711399e-02, -6.348684e-02, -1.728961e-02, -3.934286e-02,  ..., -1.331571e-02, -4.165864e-02, -4.398917e-02, -4.627629e-02, -9.174454e-03, 1.545564e-02, -1.125001e-02, -2.480576e-02, ] 
[ 3.754228e-03, 9.683584e-03, -2.480576e-02, -6.089627e-02, -6.348684e-02, 3.497662e-02, -7.159228e-03, 4.304650e-02,  ..., -5.258940e-03, -3.498925e-02, -3.934286e-02, -2.112579e-02, 3.754228e-03, -6.399561e-05, 3.497662e-02, -5.081355e-02, ] 
[ 5.786048e-03, 3.307608e-02, -1.331571e-02, 7.771323e-03, 1.349843e-02, -4.165864e-02, 8.407630e-02, -1.331571e-02,  ..., 1.349843e-02, 3.121246e-02, -1.922545e-02, 9.683584e-03, -1.125001e-02, -3.290768e-02, 2.430326e-02, 2.591513e-02, ] 
[ 1.349843e-02, 7.771323e-03, -1.784698e-03, 5.786048e-03, -3.498925e-02, -2.870734e-02, -3.711399e-02, 3.121246e-02,  ..., 7.771323e-03, -2.870734e-02, -7.159228e-03, -1.922545e-02, 3.754228e-03, 2.271003e-02, 2.591513e-02, 3.121246e-02, ] 
[ -2.480576e-02, -3.934286e-02, -2.870734e-02, 1.740456e-02, -2.297673e-02, -4.165864e-02, 3.691056e-02, -1.331571e-02,  ..., 3.121246e-02, 4.800027e-02, -2.669331e-02, -3.711399e-02, 9.683584e-03, -4.853181e-02, -5.826017e-02, -3.290768e-02, ] 
[ -1.784698e-03, -3.711399e-02, 3.887388e-02, 1.928704e-02, 3.307608e-02, 5.682385e-02, 1.157492e-02, 5.082482e-02,  ..., 2.271003e-02, 5.786048e-03, 4.304650e-02, -1.728961e-02, 7.496781e-02, 2.591513e-02, 1.776260e-03, 1.928704e-02, ] 
[ -6.399561e-05, 1.928704e-02, 2.430326e-02, -5.258940e-03, 2.938193e-02, 5.786048e-03, 1.349843e-02, 3.754228e-03,  ..., 1.740456e-02, -5.081355e-02, -1.922545e-02, 4.304650e-02, 4.304650e-02, 1.928704e-02, 1.740456e-02, -3.934286e-02, ] 
[ -6.399561e-05, -3.498925e-02, 9.683584e-03, -6.399561e-05, 5.379406e-02, -5.081355e-02, 7.937638e-02, -6.399561e-05,  ..., 4.304650e-02, 1.740456e-02, -1.728961e-02, 2.591513e-02, -1.532673e-02, 9.683584e-03, 1.157492e-02, 5.786048e-03, ] 
 ..., 
[ -1.728961e-02, -2.480576e-02, -4.165864e-02, -8.294354e-02,  ..., -5.566349e-02, 7.079315e-02, -1.532673e-02, 1.776260e-03, ] 
[ 7.079315e-02, -9.910440e-02, 9.683584e-03, 1.123841e-01,  ..., 5.082482e-02, -2.112579e-02, 3.121246e-02, 1.740456e-02, ] 
[ -3.080665e-02, 1.349843e-02, -5.081355e-02, -4.165864e-02,  ..., -3.080665e-02, 3.307608e-02, 8.407630e-02, 1.157492e-02, ] 
[ -2.297673e-02, -3.934286e-02, -1.922545e-02, -3.498925e-02,  ..., -2.112579e-02, -9.174454e-03, 3.691056e-02, 1.928704e-02, ] 
[ -1.784698e-03, 1.928704e-02, -5.317811e-02, 5.786048e-03,  ..., 1.349843e-02, 8.407630e-02, -6.599312e-02, -1.784698e-03, ] 

 product 
---------- Result ----------
x: 768
y: 7
z: 1
 ################# 0 ################# 
[ 3.653604e-01, -9.398250e-02, 4.313722e-03, -1.318889e-02, -3.313791e-01, 1.334647e-01, -1.601298e-02, 1.694016e-01,  ..., 2.811832e-01, 8.223900e-01, 6.378281e-01, -7.393885e-02, -4.246662e-01, -2.657830e-01, 8.430491e-02, 1.520030e-01, ] 
[ -3.382763e-01, 1.332900e-01, 5.084999e-02, -7.472833e-02, -5.238731e-01, -2.067206e-01, -3.598235e-03, -3.447869e-02,  ..., -5.452281e-02, -3.076022e-01, -9.418147e-02, 3.109660e-01, 1.160035e-01, -1.602852e-03, -1.192047e-02, -7.702944e-01, ] 
[ -1.631665e-01, 1.027165e-01, -1.728238e-02, -9.735615e-02, -4.689650e-01, -2.115812e-01, 5.625330e-02, -6.196941e-02,  ..., 6.584749e-02, -2.382983e-01, -6.570899e-02, 1.595742e-01, 2.321580e-01, -6.266247e-02, -1.776543e-02, -7.370872e-01, ] 
[ -2.450197e-01, 1.222088e-01, 1.102357e-01, -1.058644e-01, -4.863160e-01, -2.337088e-01, 1.501670e-02, -7.140387e-02,  ..., -5.136424e-02, -2.390287e-01, -4.604380e-02, 2.419901e-01, 1.328777e-01, -9.171987e-02, -6.110463e-02, -8.323442e-01, ] 
[ -2.062009e-01, 1.148148e-01, 1.608160e-02, -1.360099e-01, -5.247837e-01, -1.490481e-01, 6.160545e-02, -7.776585e-02,  ..., 1.710195e-02, -1.866901e-01, -3.867154e-02, 9.569325e-02, 1.290980e-01, -1.583675e-01, 1.502948e-02, -7.053674e-01, ] 
[ -2.675423e-01, 1.577792e-01, 6.403039e-02, -1.800031e-01, -5.085962e-01, -2.418546e-01, -1.896989e-02, -5.325189e-02,  ..., -2.986444e-02, -3.907175e-01, -7.648923e-02, 2.105369e-01, 5.868658e-02, 9.379391e-02, -1.168587e-01, -8.555747e-01, ] 
[ -2.595317e-01, 2.021701e-01, 5.882614e-02, -1.395285e-01, -3.716084e-01, -3.388292e-01, 6.554191e-02, -1.016241e-01,  ..., 8.157811e-03, -1.234543e-01, 1.400920e-02, 1.765621e-01, -8.450152e-04, -1.478688e-02, -8.635487e-02, -6.802337e-01, ] 
 ..., 
[ -1.631665e-01, 1.027165e-01, -1.728238e-02, -9.735615e-02,  ..., 2.321580e-01, -6.266247e-02, -1.776543e-02, -7.370872e-01, ] 
[ -2.450197e-01, 1.222088e-01, 1.102357e-01, -1.058644e-01,  ..., 1.328777e-01, -9.171987e-02, -6.110463e-02, -8.323442e-01, ] 
[ -2.062009e-01, 1.148148e-01, 1.608160e-02, -1.360099e-01,  ..., 1.290980e-01, -1.583675e-01, 1.502948e-02, -7.053674e-01, ] 
[ -2.675423e-01, 1.577792e-01, 6.403039e-02, -1.800031e-01,  ..., 5.868658e-02, 9.379391e-02, -1.168587e-01, -8.555747e-01, ] 
[ -2.595317e-01, 2.021701e-01, 5.882614e-02, -1.395285e-01,  ..., -8.450152e-04, -1.478688e-02, -8.635487e-02, -6.802337e-01, ] 

 weight 
---------- Result ----------
x: 3072
y: 192
z: 1
 ################# 0 ################# 
[ 1.157492e-02, -2.669331e-02, 1.928704e-02, -2.297673e-02, 1.776260e-03, -1.125001e-02, -2.297673e-02, -4.853181e-02,  ..., -2.669331e-02, -1.125001e-02, -3.711399e-02, -3.711399e-02, -6.399561e-05, -2.480576e-02, -2.297673e-02, -1.532673e-02, ] 
[ -3.483064e-03, 1.928704e-02, -1.922545e-02, -6.599312e-02, -3.498925e-02, -7.159228e-03, 1.157492e-02, -4.165864e-02,  ..., -2.480576e-02, -2.870734e-02, -5.317811e-02, -7.159228e-03, -4.165864e-02, -1.784698e-03, -3.711399e-02, -1.331571e-02, ] 
[ 4.089477e-02, 2.430326e-02, -7.159228e-03, 1.928704e-02, 2.591513e-02, 1.776260e-03, 3.887388e-02, -2.297673e-02,  ..., -9.174454e-03, 5.082482e-02, -1.331571e-02, 1.740456e-02, -2.480576e-02, 3.691056e-02, 7.771323e-03, 1.349843e-02, ] 
[ 1.928704e-02, -1.922545e-02, 3.887388e-02, -7.159228e-03, 3.887388e-02, 9.683584e-03, -3.711399e-02, 5.682385e-02,  ..., -1.331571e-02, 6.323280e-02, -3.483064e-03, 1.545564e-02, 2.938193e-02, -3.290768e-02, -4.165864e-02, -6.399561e-05, ] 
[ 1.545564e-02, 1.928704e-02, -1.125001e-02, 5.682385e-02, 1.545564e-02, -5.826017e-02, -1.125001e-02, -9.174454e-03,  ..., 1.545564e-02, 2.105636e-02, -1.728961e-02, 2.591513e-02, -3.483064e-03, -3.483064e-03, 4.304650e-02, -4.398917e-02, ] 
[ -2.297673e-02, -2.480576e-02, 5.682385e-02, 5.786048e-03, 1.157492e-02, -1.125001e-02, -5.317811e-02, -1.125001e-02,  ..., -2.297673e-02, -3.483064e-03, 3.754228e-03, 1.157492e-02, 4.540269e-02, 1.545564e-02, -6.399561e-05, 2.430326e-02, ] 
[ 3.307608e-02, 1.740456e-02, 2.105636e-02, 3.754228e-03, -1.331571e-02, 1.740456e-02, 2.271003e-02, 2.271003e-02,  ..., -6.399561e-05, 2.938193e-02, -7.159228e-03, 7.771323e-03, -1.331571e-02, -7.159228e-03, -2.112579e-02, -3.080665e-02, ] 
[ -2.297673e-02, 9.683584e-03, 3.121246e-02, -2.297673e-02, 1.740456e-02, -4.165864e-02, -1.532673e-02, -1.532673e-02,  ..., -2.112579e-02, 2.105636e-02, 4.089477e-02, 5.786048e-03, 2.105636e-02, 3.754228e-03, 7.771323e-03, 7.771323e-03, ] 
 ..., 
[ 2.430326e-02, -1.532673e-02, 2.591513e-02, -2.480576e-02,  ..., -1.331571e-02, 7.079315e-02, -5.081355e-02, 1.349843e-02, ] 
[ -6.850546e-02, 1.740456e-02, -9.174454e-03, 7.771323e-03,  ..., -7.159228e-03, 7.771323e-03, -5.258940e-03, -1.331571e-02, ] 
[ 5.379406e-02, 2.105636e-02, -7.159228e-03, -1.532673e-02,  ..., 5.786048e-03, -1.532673e-02, 7.496781e-02, -2.669331e-02, ] 
[ -1.922545e-02, 2.591513e-02, -3.498925e-02, -3.290768e-02,  ..., -6.399561e-05, 1.157492e-02, 2.430326e-02, -5.258940e-03, ] 
[ 1.740456e-02, -3.080665e-02, -7.159228e-03, -1.784698e-03,  ..., -3.290768e-02, -5.258940e-03, -9.174454e-03, -3.290768e-02, ] 

 product 
---------- Result ----------
x: 768
y: 7
z: 1
 ################# 0 ################# 
[ 6.588318e-01, -6.599448e-03, -8.644705e-02, -5.707886e-02, -1.735080e-01, 4.067639e-02, -1.829379e-01, 9.414256e-03,  ..., 3.256257e-02, -1.897109e-02, -3.402194e-04, 7.466936e-03, -1.345696e-02, -3.227923e-02, 3.059271e-02, 5.039664e-02, ] 
[ 5.207166e-02, 1.973612e-02, -9.660834e-03, 3.323677e-03, -3.648382e-03, -2.097212e-03, 9.949057e-03, -4.195271e-02,  ..., -4.389000e-02, 5.622626e-03, 5.181661e-02, -2.429419e-02, -7.619246e-03, -3.025457e-02, -1.810126e-02, -1.874923e-02, ] 
[ -5.318598e-02, 3.905347e-02, -3.029487e-02, 2.272218e-03, 1.166142e-02, -1.329460e-02, 1.297542e-02, 2.966494e-02,  ..., -5.204287e-02, 1.396865e-02, 5.904424e-04, 8.642940e-03, 4.299723e-02, -2.287997e-02, 2.725319e-02, 6.719646e-03, ] 
[ -3.833672e-02, -2.142037e-03, -2.152258e-02, 1.631027e-02, 1.728192e-02, 4.394060e-03, 5.952085e-02, -2.126178e-02,  ..., -3.291656e-02, -1.957882e-02, 1.370658e-02, 3.717877e-02, 6.518346e-03, -4.071972e-03, 3.357132e-03, -1.659676e-04, ] 
[ -4.627400e-02, 3.737998e-02, -1.853172e-02, 1.547872e-02, -1.302319e-02, -9.886003e-03, -4.642003e-02, 2.589880e-02,  ..., -1.067964e-01, 2.359391e-02, 6.791757e-02, -3.290311e-02, 1.127009e-01, -7.847647e-02, 3.193296e-02, -8.605040e-03, ] 
[ -1.555011e-02, 2.960180e-02, 1.306013e-04, -2.326839e-03, -5.087811e-02, 4.696768e-03, 5.093640e-02, -2.033010e-03,  ..., -2.482825e-02, 3.111352e-02, 1.060077e-02, 9.415792e-03, 1.459946e-02, -6.913905e-03, -2.805965e-02, -2.871425e-03, ] 
[ 3.314129e-02, 2.097282e-03, 3.222027e-03, 1.695356e-02, -5.644152e-02, 1.147574e-02, 6.336477e-03, -7.759203e-04,  ..., -7.655679e-03, 8.782726e-03, 2.730400e-02, 1.341341e-02, 5.525826e-03, -3.985897e-03, 1.384909e-03, 7.039747e-03, ] 
 ..., 
[ -5.318598e-02, 3.905347e-02, -3.029487e-02, 2.272218e-03,  ..., 4.299723e-02, -2.287997e-02, 2.725319e-02, 6.719646e-03, ] 
[ -3.833672e-02, -2.142037e-03, -2.152258e-02, 1.631027e-02,  ..., 6.518346e-03, -4.071972e-03, 3.357132e-03, -1.659676e-04, ] 
[ -4.627400e-02, 3.737998e-02, -1.853172e-02, 1.547872e-02,  ..., 1.127009e-01, -7.847647e-02, 3.193296e-02, -8.605040e-03, ] 
[ -1.555011e-02, 2.960180e-02, 1.306013e-04, -2.326839e-03,  ..., 1.459946e-02, -6.913905e-03, -2.805965e-02, -2.871425e-03, ] 
[ 3.314129e-02, 2.097282e-03, 3.222027e-03, 1.695356e-02,  ..., 5.525826e-03, -3.985897e-03, 1.384909e-03, 7.039747e-03, ] 

Al 2



# setting
BERT based uncased, 12 layer
1 code book, with 128 center

clustered model using int8_t for label, float32_t for center.
original model using float32_t for all weights and computing


# weight
overall model weights, gathered through du:
clustered: 100832 (kb), each layer(excepet embedding):6380 (kb), embedding: 23284(kb)
ori: 400632 (kb), each layer(excepet embedding):25400 (kb), embedding: 93120(kb)

runtime memory access:
bert matrix multiplication(MM) mostly happened in attention liner(Q,K,V 3 MM) and feed forward layer(FF1,FF2 2 MM):
attention liner(Q,K,V) MM right hand matrix size: 768*768
feed forward layer(FF1,FF2), FF1: 3072*768, FF2:768*3072


ori:
Q,K,V: 768*768 = 589824 float32_t memory access
    589824*4 = 2359296 Byte memory access(Q,K,V each)
FF1,FF2: FF1: 3072*768 =  FF2:768*3072 = 2359296 float32_t memory access
    FF1 = FF2 = 3072*768 * 4= 9437184 Byte memory access

clustered + segmented/tile memory access: 
Q,K,V: 768*768 = 589824 int8_t memory access, plus extra 128 float32_t code book mapping
    589824*1 = 589824 Byte memory access(Q,K,V each)
FF1,FF2: FF1: 3072*768 =  FF2:768*3072 = 2359296 int8_t memory access, plus extra 128 float32_t code book mapping
    FF1 = FF2 = 3072*768 * 1= 2359296 Byte memory access


Code book memory is frequently accessed, way better cache performance, right now I don't have runtime memory perf result, so I will treated as no extra memory access.
MM alone clustered version saves ~= 4 times memory access:
ori:            2359296*3 + 9437184*2
                          /                     = 4
cluster:        589824*3  + 2359296*2 

# latency:
CPU,4 thread
input token length: 16

clustered: 0.7427922499999999 (s)
ori:        1.508237(s)